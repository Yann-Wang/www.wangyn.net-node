<!DOCTYPE HTML><html><head><meta charset=utf-8><title>v8在解析promise源码时的执行环境变化过程 | Catullus | a Latin poet of the late Roman Republic</title><meta name=author content=Yann-Wang><meta name=description content=写技术，写心情，写日记><meta name=keywords content="execution environment,promise"><meta id=viewport name=viewport content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui"><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><meta property=og:title content=v8在解析promise源码时的执行环境变化过程><meta property=og:site_name content=Catullus><meta property=og:image content=/favicon.ico><link href=/favicon.ico rel=icon><link rel=alternate href=/atom.xml title=Catullus type=application/atom+xml><link rel=stylesheet href=/css/style.css media=screen type=text/css></head><body><div class=blog><div class=content><header><div class=site-branding><h1 class=site-title><a href="/">Catullus</a></h1><p class=site-description>a Latin poet of the late Roman Republic</p></div><nav class=site-navigation><ul><li><a href="/">Home</a></li><li><a href=/archives>Archives</a></li></ul></nav></header><main class="site-main posts-loop"><article><h3 class=article-title><span>v8在解析promise源码时的执行环境变化过程</span></h3><div class=article-top-meta><span class=posted-on><a href="/2016/08/24/promise implementing and analysis/" rel=bookmark><time class="entry-date published" datetime=2016-08-24T13:40:55.000Z>2016-08-24</time></a></span></div><div class=article-content><div class=entry><ul><li><p>首先，先去<a href="https://www.promisejs.org/implementing/" target=_blank rel=external>Promise官网</a>看implementing这篇文章．</p></li><li><p>下面是我对源码的一个解读</p><iframe scrolling=no width=100% height=300 src=http://jsfiddle.net/01duqtsu/embedded/js,html,result/light frameborder=0 allowfullscreen></iframe><a id=more></a></li><li><p>在执行代码是为了避免使用Node中已经实现的Promise，所以将Promise改名为Promise2， 并且把测试环境设为了浏览器中．在上面的代码中，把Promise的实现部分放在了javascript文件中，并在html文件的head中引入； 对promise的使用放在了html文件的script标签中．</p></li><li><p>当javascript文件被载入浏览器时， 浏览器创建４个函数对象：Promise2, getThen, doResolve, Promise2.resolve（注意：函数体中的代码没有被解析）</p></li><li><p>从调用Promise2.resolve函数开始<br><img src=/images/ExecutionEnvironment.png></p></li><li><p>Promise2.resolve(“Success”)返回 一个对象，包括done属性和then属性，这两个属性的属性值都是一个函数．<br><img src=/images/ExecutionEnvironment2.png></p></li><li><p>Promise实现中包含了控制反转等面向对象的设计原则，函数参数的访问链是比较难分析的点．</p></li><li><p>以下要点会有助于理解：</p><ul><li>函数的访问链指向它被定义时所在的函数．</li><li>函数声明被解析时，其函数体没有被解析更没有被执行．</li></ul></li></ul></div></div><div class=article-footer><div class="article-meta pull-left"><span class=post-categories><i class=icon-categories></i> <a href="/categories/technology/">technology</a></span> <span class=post-tags><i class=icon-tags></i> <a href="/tags/execution-environment/">execution environment</a><a href="/tags/promise/">promise</a></span></div></div></article><div id=comment><div class=ds-thread data-thread-key="/2016/08/24/promise implementing and analysis/" data-title=v8在解析promise源码时的执行环境变化过程 data-url="http://www.wangyn.net/2016/08/24/promise implementing and analysis/"></div><script type=text/javascript>
	var duoshuoQuery = {short_name:"Yann-Wang"};
	  (function() {
	    var ds = document.createElement('script');
	    ds.type = 'text/javascript';ds.async = true;
	    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	    ds.charset = 'UTF-8';
	    (document.getElementsByTagName('head')[0] 
	     || document.getElementsByTagName('body')[0]).appendChild(ds);
	  })();
	  </script></div></main><footer class=site-footer><p class=site-info>Proudly powered by <a href="https://hexo.io/" target=_blank>Hexo</a> and Theme by <a href=https://github.com/CodeDaraW/Hacker target=_blank>Hacker</a><br>&copy; 2016 Yann-Wang</p></footer></div></div></body></html>